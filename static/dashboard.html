<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Dashboard</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 40px;
      }
      h1 {
        color: #2d6cdf;
      }
      button {
        padding: 10px 20px;
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <h1>Welcome to the Dashboard!</h1>
    <p>You are now logged in âœ…</p>
    <button onclick="logout()">Logout</button>
    <button onclick="goToMovieSearch()">Go to Movie Search</button>

    <script>
      function logout() {
        localStorage.removeItem("token");
        window.location.href = "/static/login.html";
      }
      function goToMovieSearch() {
        const token = localStorage.getItem("token");
        if (!token) {
          logout();
        } else {
          // Use fetch to pass Authorization header & load dashboard
          fetch("/dashboard", {
            headers: {
              Authorization: "Bearer " + token,
            },
          })
            .then((res) => {
              if (!res.ok) {
                logout(); // invalid/expired token
              } else {
                return res.text();
              }
            })
            .then((html) => {
              document.open();
              document.write(html);
              document.close();
            });
        }
      }
    </script>
  </body>
</html>
